# Общая концепция:
- Web приложение для автоматизации вызова сотрудников на рабочую смену.
- Предусмотрены разные роли и уровни доступа (по убыванию прав): Root, админ, модератор, начальник цеха, бригадир, рабочий... (список может быть дополнен).

- Начальник цеха(и выше) может создавать теги для чего угодно (Предусмотрено создание данных заранее при разработке).
Например: работа на высоте, длительное время, vip персона, повышенная опасность, опера, балет,и т.д. Тег сохраняется в отдельную таблицу и просто существует, дальше может быть привязан к чему угодно.

- Начальник цеха(и выше) может создавать события для вызова на рабочую смену (Предусмотрено создание данных заранее при разработке).
 В нашем случае спектакль/ концерт/ шоу. Можно привязать теги к событию.
- Например, создается событие "Лебединое озеро", тег "балет". Или событие "Приглашенная рок группа", теги: "vip персона", "длительное время".

- Начальник цеха(и выше) может создавать тип смены. (Предусмотрено создание данных заранее при разработке)
- Например: монтаж спектакля, демонтаж спектакля, проведение спектакля, репетиция полная, репетиция с выгородкой, и т.д

- Бригадир(и выше) может создавать смену.
- Смена - самая важная часть всего проекта!
- В смене указываются: Дата, событие, тип смены, место смены, список сотрудников, теги.
- Например: 
    - Дата: 2020-01-01, 
    - Событие: "Пикова дама",
    - Тип смены: "монтаж спектакля",
    - Место: "большая сцена",
    - Список сотрудников: "Насонов, Лошкарев", 
    - Теги: "опера длительное время"

- Всё это дело сохранятся и каждый вызванный сотрудник будет знать о предстоящей смене или об уже прошедшей. Смена сохраняется в БД и может быть использована как шаблон для создания новой смены на такое-же "событие + тип смены".
- Например: Если ранее уже была смена "Щелкуничк, репетиция полная" с вызовом конкретных людей, то можно использовать старую смену как шаблон, при необходимости отредактировать (поменять состав людей) и после создать новую смену с новой датой.

- Руководитель и подчиненные смогут увидеть статистику по проделанной работе за период для каждого из сотрудников. Руководитель видит всех сотрудников, а рядовой рабочий видит только свою статистику.

- Предполагается, что сотрудники будут регистрироваться на сайте указывая свои данные. Но также предусмотрен механизм для ручного создания пользователя (начальник цеха и выше), для последующей передачи логина и пароля сотруднику.
- Root пользователя можно создать только один раз при развертывании проекта с нуля. Root создает админа, админ может создавать начальников цехов.

- TODO сам цех пока один, расширение возможно, но пока нужно сделать проект в рамках одного цеха - "монтировщики".

- Начальник цеха(и выше) может редактировать данные сотрудников, добавить теги и описание.

# Развертывание проекта на локальном пк:
- Используемые технологии в API: nodejs + nestjs, пакетный менеджер npm, postgres SQL + typeORM. Проект пишется на языке typescript.
- Для разработки рекомендуется использоваться VS code.

- Скачать проект по ссылке (ссылка передается вручную).
- Установить nodejs, typescript и npm на пк под управлением Ubuntu, Debian или Mint.
- Зайти в папку с проектом и написать в консоль npm ci. nestjs  установится автоматически.
- Установить postgres SQL, пример настроек по умолчанию в проекте:
      type: 'postgres',
      host: 'localhost',
      port: 5432,
      username: 'alex',
      password: '123',
      database: 'postgres',

- По умолчанию проект использует порт 4000, все роуты для запросов к api имеют постфикс api, пример: http://localhost:4000/api/нужный-роут

- Запуск проект делается командой npm run watch.

# Создание root пользователя:
- После развертывания и удачного запуска проекта нужно создать root пользователя, который в дальнейшем сможет создавать админов, начальников цехов, а также изменять права доступа для уже существующих пользователей.

- Для создания root пользователя на сделать POST запрос по роуту api/create-root-user с пустым объектом в теле.
- По умолчанию будет создан пользователь alex с паролем 123. При необходимости можно поправить метод createRootUser() и выбрать подходящее имя для рута и нужный пароль. Если в БД уже существует пользователь с таким ником, то рут не будет создан.
- Результат создания можно проверить в БД, в таблице user.

# Регистрация и авторизация пользователей:
- роут api/register
- принимает: 
    @IsString()
    login: string;

    @IsString()
    pswd: string;

    @IsEmail()
    email: string;

- TODO в данный момент подтверждение почты не делается, антибота нет. Можно наспамить любое количество пользователей.
- В случае удачной регистрации в ответе будет jwt token в которым зашиты: логи и уровень доступа.
- Все дальнейшие запросы к апи проверяют уровень доступа по токену.

- Другие роуты для регистрации и авторизации можно найти в src/User/user.controller.ts
- Описание таблиц пользователей: src/User/Entity

# Админка по пользователям:

- Роуты: src/Admin-user/admin-user.controller.ts
- Используется те-же таблицы, что и для обычных пользователей.
